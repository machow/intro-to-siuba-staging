<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Group by - Siuba tutorials</title><meta name="gridsome:hash" content="9e7e9c1b4bb54210860ee2d05e2ce6a60f3f878a"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.13"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="og:url" name="og:url" content="undefined/"><meta data-vue-tag="ssr" name="author" content=""><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.4c9809035c230f0e6cac26955353be8b.png"><link rel="preload" href="/assets/css/0.styles.c32742f7.css" as="style"><link rel="preload" href="/assets/js/app.bddb7936.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--course-landing-vue.086594e8.js" as="script"><link rel="preload" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-b-group-by-md.714192d5.js" as="script"><link rel="prefetch" href="/assets/js/25.8a620e99.js"><link rel="prefetch" href="/assets/js/26.f6293d18.js"><link rel="prefetch" href="/assets/js/27.aac19fb0.js"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.0910fdc2.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.eb9ea64c.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.1e7f4da1.js"><link rel="prefetch" href="/assets/js/page--src--pages--test-vue.82a74315.js"><link rel="prefetch" href="/assets/js/page--src--templates--post-vue.6cd27920.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-b-filter-md.7f037958.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-c-arrange-md.2b1d2334.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-d-mutate-md.0463199c.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-f-wrap-up-md.feb47006.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-intro-data-science-md.020363e1.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-a-intro-data-viz-md.49d46fcd.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-b-geoms-md.13f2dfbe.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-c-aesthetics-md.5f6ff605.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-d-facets-md.60ee8c03.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-a-summarize-md.31b483ed.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-c-summary-viz-md.92671fe8.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-a-line-plots-md.f40f2afb.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-b-barcharts-md.3750238c.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-c-histograms-md.03133726.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-d-boxplot-md.3fb096fa.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--index-md.ef1f110f.js"><link rel="stylesheet" href="/assets/css/0.styles.c32742f7.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-839724a0><h1 class="course-title" data-v-839724a0>Group by</h1><div class="container" data-v-839724a0><div class="main" data-v-839724a0></div><div class="sidebar" data-v-839724a0><div class="resources sidebar-box" data-v-839724a0><h3 class="box-title" data-v-839724a0>resources</h3></div><div class="authors sidebar-box" data-v-839724a0><h3 class="box-title" data-v-839724a0>authors</h3></div></div></div><div data-v-839724a0><div><details style="display:none;"><div language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div></div><div class="container-editor container"></div></div></div></details><div><div class="reveal-container"><div class="reveal show-notes"><div class="slides"><section class=""><section class=""> <h1 id=the-group_by-verb>The group_by verb</h1> <p>In the last lesson, you used the summarize verb to calculate an average either,</p> <ul> <li>across all countries (the entire dataset)</li> <li>within a particular country (filtered data)</li> </ul> <p>In this lesson you&#39;ll learn the group_by verb, which opens up a new option for calculating an average:</p> <ul> <li>within each country</li></ul></section></section><section class=""><section class="">   <h1 id=the-group_by-verb-1>The group_by verb</h1> <p><img src=/assets/img/model_group_by.5d6d9d3e.png alt=""></p> <aside class=notes> <p>You use group_by to define groupings of data (blue and green chunks in diagram).</p> <p>Then, you would follow it with summarize to convert those groups to a single value (like a mean).</p> </aside></section></section><section class=""><section class=""> <h1 id=the-summarize-verb>The summarize verb</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; filter(_.country == &quot;Japan&quot;)
  &gt;&gt; summarize(avg_duration = _.duration.mean()))</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>avg_duration</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>250.53499</td> </tr> </tbody> </table> </div> <aside class=notes> <p>For example, here you&#39;re finding the average track duration in Japan.</p> <p>What if we weren&#39;t interested just in the average duration for Japan, but for each country in the dataset?</p> <p>You could rerun this code and change the country each time, but that&#39;s very tedious.</p> </aside></section></section><section class=""><section class=""> <h1 id=summarizing-by-country>Summarizing by country</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; group_by(_.country)
  &gt;&gt; summarize(avg_duration = _.duration.mean())
)</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>country</th> <th>avg_duration</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Argentina</td> <td>212.847855</td> </tr> <tr> <th>1</th> <td>Australia</td> <td>204.795300</td> </tr> <tr> <th>2</th> <td>Austria</td> <td>184.894870</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> </tr> <tr> <th>59</th> <td>United States</td> <td>190.827500</td> </tr> <tr> <th>60</th> <td>Uruguay</td> <td>210.796985</td> </tr> <tr> <th>61</th> <td>Viet Nam</td> <td>217.222830</td> </tr> </tbody> </table> <p>62 rows × 2 columns</p> </div> <aside class=notes> <p>Instead, you can use the group_by verb, which tells siuba to summarize within groups instead of summarizing the entire dataset. Notice that this replaces the filter country equals Japan with group_by country.</p> <p><code>group_by(_.country)</code> tells the summarize step that it should perform the summary within each country: within Argentina, then within Australia, and so on through Viet Nam, then combine the results.</p> <p>Instead of getting one row overall, you now get <strong>one row for each country</strong>. There&#39;s now a year variable along with the new avg_duration variable.</p> </aside></section></section><section class=""><section class=""> <h1 id=summarizing-by-continent-and-position>Summarizing by continent and position</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; group_by(_.continent, _.position)
  &gt;&gt; summarize(
      min_streams = _.streams.min(),
      max_streams = _.streams.max()
  )
)</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>continent</th> <th>position</th> <th>min_streams</th> <th>max_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Africa</td> <td>1</td> <td>94422</td> <td>94422</td> </tr> <tr> <th>1</th> <td>Africa</td> <td>2</td> <td>74689</td> <td>74689</td> </tr> <tr> <th>2</th> <td>Africa</td> <td>3</td> <td>67552</td> <td>67552</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>997</th> <td>Oceania</td> <td>198</td> <td>44570</td> <td>225951</td> </tr> <tr> <th>998</th> <td>Oceania</td> <td>199</td> <td>44364</td> <td>225492</td> </tr> <tr> <th>999</th> <td>Oceania</td> <td>200</td> <td>44291</td> <td>225179</td> </tr> </tbody> </table> <p>1000 rows × 4 columns</p> </div> <aside class=notes> <p>You can also group by multiple variables.</p> <p>Suppose you&#39;re interested calculating min and max streams within each continent, and each position.</p> <p>Now the output has one row for each combination of a continent and position.</p> <p><strong>(Click down to see what the steps leading to this code might look like)</strong></p> </aside></section><section class=""> <h1 id=summarizing-by-continent-and-position-1>Summarizing by continent and position</h1> <pre><code class=language-python>(music_top200

  &gt;&gt; summarize(
      min_streams = _.streams.min(),
      max_streams = _.streams.max()
  )
)</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>min_streams</th> <th>max_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>1470</td> <td>12987027</td> </tr> </tbody> </table> </div> <aside class=notes> <p>You might start by summarizing min and max streams across all the data.</p> </aside></section><section class=""> <h1 id=summarizing-by-continent-and-position-2>Summarizing by continent and position</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; filter(_.continent == &quot;Oceania&quot;, _.position == 1)
  &gt;&gt; summarize(
      min_streams = _.streams.min(),
      max_streams = _.streams.max()
  )
)</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>min_streams</th> <th>max_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>321272</td> <td>1757343</td> </tr> </tbody> </table> </div> <aside class=notes> <p>Then, you might add a filter, so your summarize is over one specific grouping (position 1 tracks in Oceania).</p> </aside></section><section class=""> <h1 id=summarizing-by-continent-and-position-3>Summarizing by continent and position</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; group_by(_.continent, _.position)
  &gt;&gt; summarize(
      min_streams = _.streams.min(),
      max_streams = _.streams.max()
  )
)</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>continent</th> <th>position</th> <th>min_streams</th> <th>max_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Africa</td> <td>1</td> <td>94422</td> <td>94422</td> </tr> <tr> <th>1</th> <td>Africa</td> <td>2</td> <td>74689</td> <td>74689</td> </tr> <tr> <th>2</th> <td>Africa</td> <td>3</td> <td>67552</td> <td>67552</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>997</th> <td>Oceania</td> <td>198</td> <td>44570</td> <td>225951</td> </tr> <tr> <th>998</th> <td>Oceania</td> <td>199</td> <td>44364</td> <td>225492</td> </tr> <tr> <th>999</th> <td>Oceania</td> <td>200</td> <td>44291</td> <td>225179</td> </tr> </tbody> </table> <p>1000 rows × 4 columns</p> </div> <aside class=notes> <p>Finally, you might replace the filter with a group_by.</p> <p>Note that you might save this result as a variable and use it in a new pipe or visualization. For example, the new pipe might filter to keep where position is 1, so you can inspect min and max streams for the top tracks across continents.</p> </aside><aside class=notes> </aside></section></section><section class=""><section class=""> <h1 id=lets-practice>Let&#39;s practice!</h1> </section></section></div></div></div></div><h3 id="exercise-1"><a href="#exercise-1" aria-hidden="true"><span class="fa fa-link"></span></a>Exercise 1:</h3><p>Modify the code below so it calculates max popularity and average danceability <strong>for each artist</strong>.</p><div ex="a" exIndx="0" language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>max_popularity</th><th>avg_danceability</th></tr></thead><tbody><tr><th>0</th><td>99</td><td>0.677937</td></tr></tbody></table><p>1 rows × 2 columns</p></div><div class="container-editor container"></div></div></div><p>Make a scatterplot of the data.</p><div ex="a" exIndx="0" language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div></div><div class="container-editor container"></div></div></div><p>In the plot above, what strange thing is going on with the distribution of max popularity?</p><details><summary>possible answer</summary><p>There are many artists with a max popularity of 0! </p></details><h3 id="exercise-2"><a href="#exercise-2" aria-hidden="true"><span class="fa fa-link"></span></a>Exercise 2:</h3><p>In the last exercise of the facets chapter, you examined track features for three artists.</p><div ex="a" exIndx="0" language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div></div><div class="container-editor container"></div></div></div><p>We used a plot and intuition to judge who tended to have highest energy and valence tracks.</p><div ex="a" exIndx="0" language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div><pre><code>/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/plotnine/utils.py:371: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
</code></pre><p><img alt="png" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 482 293' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-e2a791a2c9033a94167b22cadb76f55b'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-e2a791a2c9033a94167b22cadb76f55b)' width='482' height='293' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAnCAYAAAC/mE48AAAACXBIWXMAAAsTAAALEwEAmpwYAAAG3ElEQVRo3sVaZ1PrOhDN//81zMAHGBiGdimXXhII6U4jEBJSHbfs0xFZX9u4xTh5ntHItiRrtTpb5Qz5XPP5PLRwH8uyXOMMw6Blr7AxPFdcmpJcmaDFhzEE12QyoT9//tDx8TGdnZ3J%2bvz8nLa2tuj09JT29vbo%2bvrablcUhY6Ojuj29lY%2bo08%2bn5fl/v6eTk5OaH9/X9a7u7v08vISuvAgmpdlRiYOx/0u0zSpUCjQ4%2bMjlctl2tzcpE6nQ9lsVpZcLkdPT0%2byDfdvb2%2byb71ep2KxKNsqlQq1223Z5/n5Wd6jL5hSq9VCCfejLwkSMn5cLJVKcnGoQRwWhJ17fX2V9w8PD3KHqtUqNZtNubtYDEqj0ZAFC0WNNvTBAsEAjEMbCtrwDSwW9/yOayADczJT7u7uJF34FmgDI1GjXdO0ZAhwQocLJsXFMg4mANqXl5c2hAF/EOqUYxB2dXVlv8N4IAUXFgp4g2BGENp5Diwi%2b5S123Dd3NzIeXZ2diTTcY/5QQf6MO1g/GAwSC4C3kEXFxc2AsBlFDAFu4AabVxzO5gEWEMPgCB%2b7yz8TXv3it91pVShfO5FLoz7cj/MCdQAeXiPZ%2b%2b8QJaqqr9DAHbi8/OTRqOR/GiSazab2bIbhxCBN1m/6R1q62%2bklGuJZTmxDuBBuq5LGEL2ojRwkFaeTqdy95mhcceplkpjY0LlUjnRvL%2b2At5BgJbzfdRETgZA1mMjwPkNa07FUvFXCEjkB/gpQS8Dwu6TMoDbNUujL3MQyoA0djqWGeQ6CAGWEBNL11JBALcPjAEVVWEZhDFYlgFpMCEWAuzdardIazZWIgJhDIhC4K8R4P0g2%2bogbqclAtznw%2bhSTVUCrYCNli9DmEx1oWTTEQUbAXBcYMJ6vZ6LAVG7kQYDtLlGI2PssgK%2b35%2bYdH87DkVFmKWIZACIf39/lx6dS/aFm4n7WV0hS52mJgKufgEi4F0Ydr5amQlmWIGWahn/IOO3y14RmBbyYuEq9Xe3Se9%2bpKsDFt1My/wxb9ACHgQKWk0t0lL5KU3vsysaZOfFVoLSPlsrEQHvWMztxwC%2bHw1N4e5agXRwTIH5d7a3ZdyB8BveaRj9GQwE7DkACfMD5gsGBSnIVTKgWdeo3zNsBRgE/a%2bvL/oQLj3ceoTgvC4Onn4gAC7w4eGhTHAwIZIBi46zWpWsmRrLHqfNgDCvM/Rb1TKNBCN29/ZkkgVBFtbICRkXA6D8kLXhaMrWAawcP7s0N/RQc7gOBATJsS8tqk6mWNdUrAkbPB6PaTgcypAZNLoYgEQCUlCIApHAgDhwPsBvcokKpUpGv7cWBPB98VUVliraF0H9ZnyQNbekNUNShXMFfn0lA5DsQCfIDGQHMXeYTTUnY5dLvA4GjEbfMgwmDAZGKALquiJD7VarJXMHfolX7p%2bBckAW54cIRNjWdYmA93kyNqlSVn0YsMgwwFcQil%2bdqpIB49HY3liE%2bqihKG0E%2bHlnTitgO0pikHSEhEJUSwVfmVwlAuK646gLeVUsckhnZ6cyQ4UMNbJGuEdaDaiwGeCnWPyCIa3VpLlpSFNoqer/goAo93aZuMAWAT85ZzMon4UWnQsxmTX%2bucGrcIXjMKDd0qjV0CIt0j%2b32XJlppzPLhEIc4Unz9%2bZWv3jnYYXZ4vsjbVyBPhBHw7QMlFgnESKKycog6FOh/JCRmZCzi2HYjR6n65cwDoQEDcjlUo4DGuAkx1oyIIQAQumbmE%2btGadxve3NLr6m2pOMA4ChgNTxgErTYn9EIGFEuRLFWHq6OZS6oJ1BUN2suRdp%2b6HvrJk6Y%2bUmCUWWW40yRBh76z2neKeZB9d7vC6lOCqYB95Nvjy98J2db89v4kdCUadCzAD4p4LhCFg2fKr02HnRwrCf9aF02N02mQK5WcJN1lXqkudDCW5kp5IpXc6vPApc8IKDITj03vO0UCp0VQESmOhHCdih%2bEyY6cRPqPwM0q/35enSogvEIHxe2/foGecTPHzdDEXt0V9K1UElAUUKzWF6u02vYp7HEwq9TrVBLzhUsJRwk6jINqCawnow/fGOz7yxoL4GB3PODzls38U5zE7j8XRGh/PYV7ui8iOj%2b7Qn4/O%2bWjdDFDQif4QsQMPwVlMwuExnkE0R4vdble2gXjvhQiM/wCRlkTsGBbACVeMBeRBvPeCT8L/AfC8zrGIXDEvH8%2bn/oMEKzBwFYRDtvEOi8IzCtpBKOCO90530zkWxCPXAJGAiIB49MFYLjwmybxOZZsKAuJyMywQcRIESG9sbMiU1MHBgfyVxhl6B4XWy9CV6k9SUYcMcVLNzm9gN3m3sPv4D8hvbNJ5f%2bsZ/geddw%2bqDObt5QAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="482" data-src="/assets/static/03b-group-by_11_1.8e7c192.647ad2f32f107cd70cca876c8c7c6e60.png" data-srcset="/assets/static/03b-group-by_11_1.8e7c192.647ad2f32f107cd70cca876c8c7c6e60.png 482w" data-sizes="(max-width: 482px) 100vw, 482px" class="g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/03b-group-by_11_1.8e7c192.647ad2f32f107cd70cca876c8c7c6e60.png" class="g-image g-image--loaded" width="482" alt="png"></noscript></p></div><div class="container-editor container"></div></div></div><p>Now you should be able to answer the question more directly!</p><p><strong>Use a grouped summarize to calculate the mean energy and valence for each artist</strong>.</p><div ex="a" exIndx="0" language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div></div><div class="container-editor container"></div></div></div><p>Q: In this data, which artist has the lowest average energy, and what is its value?</p><details><summary>answer</summary>Billie Eilish, 0.321004</details><p>Q: What about for lowest average valence?</p><details><summary>answer</summary>Billie Eilish, 0.266948</details><!----></div></div></div>
    <script>window.__INITIAL_STATE__={"data":{"metadata":{"siteName":"Siuba tutorials","siteDescription":""},"page":{"id":"1a8325d9529b7f528629687e30695813","title":"Group by","content":"\n\u003CNotebook\n  v-slot=\"nb\"\n  branch=\"master\"\n  repo=\"machow\u002Fintro-to-siuba\"\n  url=\"https:\u002F\u002Fmybinder.org\"\n  useBinder=\"1\"\n  useStorage=\"1\"\n  \u003E\n\n\n\u003Cdetails v-fix-codemirror v-show=\"nb.debut\"\u003E\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\" :onReady=\"nb.updateSetupCode\"  language=\"python\"\u003E\n\n\n    # TODO: explain how to run this, and that they only need the gist (loads tools)\n    \n    # wranglign ---------\n    import pandas as pd\n    from siuba import *\n    \n    # plotting ----------\n    from plotnine import *\n    \n    theme_set(theme_classic(base_family = \"Noto Sans CJK JP\"))\n    \n    # data --------------\n    from music_top200 import music_top200, track_features\n    \n    # student support ----------\n    from siuba import pipe\n    from IPython.display import HTML, display\n    from siututor import Blank\n    ___ = Blank()\n    \n    # DataFrame display --------\n    pd.set_option(\"display.max_rows\", 6)\n    \n    from IPython import get_ipython\n    # special ipython function to get the html formatter\n    html_formatter = get_ipython().display_formatter.formatters['text\u002Fhtml']\n    \n    # here, we avoid the default df._repr_html_ method, since it inlines css\n    # (style tags make vue angry)\n    html_formatter.for_type(\n        pd.DataFrame,\n        lambda df: df.to_html(max_rows = pd.get_option(\"display.max_rows\"), show_dimensions = True)\n    )\n    \n    # remove the \u003Cggplot: (528...)\u003E printout\n    html_formatter.for_type(ggplot, lambda g: \"\")\n    \n\n\n\n\n\u003C\u002Fcode-cell\u003E\n\u003C\u002Fdetails\u003E\n\n\nimport slides from '..\u002Fslides\u002F03b-slides.markdown'\n\n\u003CRevealSlides :slides=\"slides\" \u002F\u003E\n\n### Exercise 1:\n\nModify the code below so it calculates max popularity and average danceability **for each artist**.\n\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\"\u003E\n\n\n    artists = (track_features\n      \u003E\u003E summarize(\n          max_popularity = _.popularity.max(),\n          avg_danceability = _.danceability.mean()\n      )\n    )\n    artists\n\n\n\u003Ctemplate v-slot:output\u003E\n\n\n\n\n\u003Ctable border=\"1\" class=\"dataframe\"\u003E\n  \u003Cthead\u003E\n    \u003Ctr style=\"text-align: right;\"\u003E\n      \u003Cth\u003E\u003C\u002Fth\u003E\n      \u003Cth\u003Emax_popularity\u003C\u002Fth\u003E\n      \u003Cth\u003Eavg_danceability\u003C\u002Fth\u003E\n    \u003C\u002Ftr\u003E\n  \u003C\u002Fthead\u003E\n  \u003Ctbody\u003E\n    \u003Ctr\u003E\n      \u003Cth\u003E0\u003C\u002Fth\u003E\n      \u003Ctd\u003E99\u003C\u002Ftd\u003E\n      \u003Ctd\u003E0.677937\u003C\u002Ftd\u003E\n    \u003C\u002Ftr\u003E\n  \u003C\u002Ftbody\u003E\n\u003C\u002Ftable\u003E\n\u003Cp\u003E1 rows × 2 columns\u003C\u002Fp\u003E\n\n\n\n\u003C\u002Ftemplate\u003E\n\n\u003C\u002Fcode-cell\u003E\n\n\nMake a scatterplot of the data.\n\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\"\u003E\n\n\n\u003Cpre\u003E\u003Ccode\u003E\n\n\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\u003C\u002Fcode-cell\u003E\n\n\nIn the plot above, what strange thing is going on with the distribution of max popularity?\n\n\u003Cdetails\u003E\n\u003Csummary\u003Epossible answer\u003C\u002Fsummary\u003E\n\nThere are many artists with a max popularity of 0! \n  \n\u003C\u002Fdetails\u003E    \n\n### Exercise 2:\n\nIn the last exercise of the facets chapter, you examined track features for three artists.\n\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\"\u003E\n\n\n    # This code keeps the 3 artists listed ----\n    \n    artists_to_keep = [\"Billie Eilish\", \"ITZY\", \"Roddy Ricch\"]\n    \n    some_artists = (\n      track_features\n      \u003E\u003E filter(_.artist.isin(artists_to_keep))\n    )\n    \n    #uncomment line below to see data\n    #some_artists\n\n\n\n\n\u003C\u002Fcode-cell\u003E\n\n\nWe used a plot and intuition to judge who tended to have highest energy and valence tracks.\n\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\"\u003E\n\n\n    # This code plots the data ----\n    (some_artists\n      \u003E\u003E ggplot(aes(\"energy\", \"valence\", color = \"artist\"))\n       + geom_point()\n       + facet_wrap(\"~artist\", nrow = 1)\n       + labs(title = \"Song features across 3 artists\")\n    )\n\n\n\u003Ctemplate v-slot:output\u003E\n\n    \u002Fopt\u002Fhostedtoolcache\u002FPython\u002F3.8.12\u002Fx64\u002Flib\u002Fpython3.8\u002Fsite-packages\u002Fplotnine\u002Futils.py:371: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n\n\n\n    \n![png](.\u002F03b-group-by_files\u002F03b-group-by_11_1.png)\n    \n\n\n\n\n\n\n\n\n\n\u003C\u002Ftemplate\u003E\n\n\u003C\u002Fcode-cell\u003E\n\n\nNow you should be able to answer the question more directly!\n\n**Use a grouped summarize to calculate the mean energy and valence for each artist**.\n\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\"\u003E\n\n\n\u003Cpre\u003E\u003Ccode\u003E# summarizing mean energy and valence for each artist\n\n\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\n\n\u003C\u002Fcode-cell\u003E\n\n\nQ: In this data, which artist has the lowest average energy, and what is its value?\n\n\u003Cdetails\u003E\u003Csummary\u003Eanswer\u003C\u002Fsummary\u003EBillie Eilish, 0.321004\u003C\u002Fdetails\u003E\n\nQ: What about for lowest average valence?\n\n\u003Cdetails\u003E\u003Csummary\u003Eanswer\u003C\u002Fsummary\u003EBillie Eilish, 0.266948\u003C\u002Fdetails\u003E\n\n\n\u003C\u002FNotebook\u003E\n\n","chapters":[],"authors":[],"resources":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.bddb7936.js" defer></script><script src="/assets/js/page--src--templates--course-landing-vue.086594e8.js" defer></script><script src="/assets/js/vue-remark--tutorial--intro-data-science--build--03-b-group-by-md.714192d5.js" defer></script>
  </body>
</html>
